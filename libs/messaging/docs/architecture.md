# 架构设计文档

## 概述

`@hl8/messaging` 采用混合架构模式：Clean Architecture + CQRS + 事件溯源（ES）+ 事件驱动架构（EDA）。

## 架构层次

```
┌─────────────────────────────────────────────────────────────┐
│                    Application Layer                       │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   Message   │  │   Event     │  │    Task     │        │
│  │   Service   │  │   Service   │  │   Service   │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
├─────────────────────────────────────────────────────────────┤
│                     Domain Layer                           │
├─────────────────────────────────────────────────────────────┤
│                  Infrastructure Layer                       │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   Kafka     │  │  RabbitMQ   │  │    Redis    │        │
│  │   Adapter   │  │   Adapter   │  │   Adapter   │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

## 核心组件

### MessagingService

提供消息发布、订阅、处理等核心功能

### EventService

提供事件发布、订阅、处理等功能，支持事件溯源

### TaskService

提供任务调度、执行、监控等功能

### 适配器架构

- BaseAdapter: 抽象基类
- KafkaAdapter: Kafka 适配器
- RabbitMQAdapter: RabbitMQ 适配器
- RedisAdapter: Redis 适配器
